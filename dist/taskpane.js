!function(){var e={60947:function(e,t,n){"use strict";e.exports=n.p+"8a005d9015e3070e7aaa.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){n("Lese Daten aus Excel...","normal"),Excel.run((function(e){var r=e.workbook.worksheets.getActiveWorksheet();return r.load("name"),e.sync().then((function(){var n=r.name;console.log("Aktives Arbeitsblatt:",n);var o=n.toLowerCase(),a=["pax","time","mainroom","sideroom1","sideroom2","sideroom3","sideroom4","sideroom5","sideroom6","sideroom7","sideroom8","chairs","setup","setdown","manager","pa","extra1","extra2","extra3","extra4","extra5","extraclick1","extraclick2","extraclick3","extraclick4","extraclick5"],c=["pa","extraclick1","extraclick2","extraclick3","extraclick4","extraclick5"],i=e.workbook.names;i.load("items/name, items/type");var s={ws_format:o,format:"both"};return a.forEach((function(e){s[e]=null})),e.sync().then((function(){console.log("Gefundene benannte Bereiche:",i.items.map((function(e){return{name:e.name,type:e.type}})));for(var n=[],r=0;r<a.length;r++)for(var l=a[r],u=o+"_"+l,d=0;d<i.items.length;d++)if(i.items[d].name.toLowerCase()===u){n.push({name:i.items[d].name,functionName:l,isCheckbox:c.includes(l)});break}return console.log("Zu verarbeitende benannte Bereiche:",n),t(e,n,s,0)}))})).then((function(e){console.log("Gesammelte Daten:",e),n("Daten erfolgreich ausgelesen. Bereite Präsentation vor...","normal");var t="https://musicworksnas.synology.me:5049/api/concept",r={ws_format:e.ws_format,format:e.format},o=["pa","extraclick1","extraclick2","extraclick3","extraclick4","extraclick5"];return Object.keys(e).forEach((function(t){"format"!==t&&"ws_format"!==t&&(null!==e[t]&&void 0!==e[t]?o.includes(t)?r[t]=e[t]:r[t]=String(e[t]):r[t]=null)})),console.log("Daten, die an die API gesendet werden:",r),fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){if(!e.ok)throw new Error("Netzwerkfehler: "+e.status);var t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json().then((function(e){return{type:"json",data:e}})):e.blob().then((function(e){return{type:"blob",data:e}}))})).then((function(e){if("json"===e.type){var r=e.data,o=new URL(t).origin,a=o+r.pptx_url,c=o+r.pdf_url;console.log("Download-URLs:",{pptx:a,pdf:c}),function(e,t){var n=document.getElementById("downloadContainer");n.innerHTML="";var r=document.createElement("a");r.href=e,r.className="download-button pptx-button",r.textContent="PowerPoint Download",r.download="praesentation.pptx";var o=document.createElement("a");o.href=t,o.className="download-button pdf-button",o.textContent="PDF Download",o.download="praesentation.pdf";var a=document.createElement("p");a.className="download-info",a.textContent='Klicke mit Rechtsklick auf die Buttons und wähle "Link speichern unter" um die Dateien herunterzuladen.',n.appendChild(r),n.appendChild(o),n.appendChild(a),n.style.display="block"}(a,c),n("Dateien bereit zum Download.","success")}else{var i=e.data,s=function(e,t){var n="praesentation";if(t){var r=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(t);r&&r[1]&&(n=r[1].replace(/['"]/g,""))}return n.includes(".")||(e.includes("application/vnd.openxmlformats-officedocument.presentationml.presentation")?n+=".pptx":e.includes("application/pdf")&&(n+=".pdf")),n}(i.type,response.headers.get("content-disposition"));!function(e,t){var n=document.getElementById("downloadContainer");n.innerHTML="";var r=document.createElement("a");r.href=e,r.className="download-button",t.endsWith(".pptx")?(r.className+=" pptx-button",r.textContent="PowerPoint-Präsentation herunterladen"):t.endsWith(".pdf")?(r.className+=" pdf-button",r.textContent="PDF-Version herunterladen"):r.textContent="Datei herunterladen",r.download=t;var o=document.createElement("p");o.className="download-info",o.textContent="Klicken Sie auf den Button, um die Datei herunterzuladen.",n.appendChild(r),n.appendChild(o),n.style.display="block"}(URL.createObjectURL(i),s),n("Datei bereit zum Download.","success")}}))})).catch((function(e){n("Fehler bei der Verarbeitung: "+e.message,"error"),console.error("Fehler:",e)}))}))}function t(e,n,r,o){if(o>=n.length)return r;var a=n[o];try{var c=e.workbook.names.getItem(a.name).getRange();return c.load("values"),e.sync().then((function(){try{var i=c.values[0][0];null!=i&&(a.isCheckbox&&(i=!0===i||"ja"===i||"yes"===i||1===i),r[a.functionName]=i,console.log("Wert für ".concat(a.functionName," gefunden:"),i))}catch(e){console.error("Fehler beim Lesen des Werts für ".concat(a.name,":"),e)}return t(e,n,r,o+1)}))}catch(c){return console.error("Fehler beim Laden des Bereichs für ".concat(a.name,":"),c),t(e,n,r,o+1)}}function n(e,t){var n=$("#statusMessage");n.removeClass("success error"),n.text(e),"success"===t?n.addClass("success"):"error"===t&&n.addClass("error")}Office.initialize=function(t){$(document).ready((function(){$("#serverButton").click(e),n("Add-In geladen und bereit.")}))}}(),function(){"use strict";new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map